# Story 2.1: Incident List Page with Basic Display

<!-- Powered by BMAD™ Core -->

## Status
Ready for Review

---

## Story

**As an** administrator,
**I want** to view a paginated list of all cybercrime incidents reported by users,
**so that** I can see at a glance the current incident landscape and identify reports needing attention.

---

## Acceptance Criteria

1. Incident list page created at `/dashboard/incidents` route
2. Page layout includes: page title "Incidentes Reportados", search bar placeholder, filter controls area, incident list container
3. On page load, fetch all incidents via API client: `GET /admin/incidents/list`
4. Display incidents in card or table format with columns/fields:
   - ID (numeric)
   - Título (text, max 50 chars displayed, ellipsis if longer)
   - Categoría (display category title from `id_categoria`)
   - Fecha de Creación (formatted as "DD/MM/YYYY HH:mm")
   - Estado (status badge)
5. Status badges color-coded:
   - Pendiente (id_estatus=1): Yellow/Amber badge
   - Aprobado (id_estatus=2): Green badge
   - Rechazado (id_estatus=3): Red badge
6. Pagination implemented: default 50 incidents per page, with "Previous" and "Next" buttons
7. Loading state shown while fetching data (skeleton cards or spinner)
8. Empty state displayed if no incidents exist: "No se encontraron incidentes"
9. Error state handled gracefully: if API call fails, display "Error al cargar incidentes. Intente nuevamente."
10. Each incident card/row is clickable and navigates to detail page `/dashboard/incidents/[id]`

---

## Tasks / Subtasks

- [x] **Task 1: Create Incident Type Definitions** (AC: 4, 5)
  - [x] Create file `/src/lib/types/incident.types.ts`
  - [x] Define `Incident` interface matching backend response structure
  - [x] Include fields: `id`, `titulo`, `descripcion`, `id_categoria`, `id_estatus`, `nombre_atacante`, `telefono`, `correo_electronico_atacante`, `usuario_red_social`, `red_social`, `id_usuario`, `fecha_creacion`, `fecha_actualizacion`, `supervisor`, `es_anonimo`
  - [x] Define `IncidentStatus` enum: `Pendiente = 1`, `Aprobado = 2`, `Rechazado = 3`
  - [x] Add TypeScript documentation comments for each field

- [x] **Task 2: Create Incident API Client Functions** (AC: 3)
  - [x] Create file `/src/lib/api/incidents.ts`
  - [x] Import `api` client from `/src/lib/api/client.ts`
  - [x] Create `getIncidents()` function: `GET /admin/incidents/list`
  - [x] Return type: `Promise<Incident[]>`
  - [x] Add error handling with try-catch
  - [x] Export function for use in components

- [x] **Task 3: Create Incident Status Badge Component** (AC: 5)
  - [x] Create file `/src/components/incidents/IncidentStatusBadge.tsx`
  - [x] Import `Badge` from `@/components/ui/badge`
  - [x] Accept `status: IncidentStatus` prop
  - [x] Render badge with color based on status:
    - Pendiente (1): Yellow/amber (`bg-yellow-100 text-yellow-800`)
    - Aprobado (2): Green (`bg-green-100 text-green-800`)
    - Rechazado (3): Red (`bg-red-100 text-red-800`)
  - [x] Display status text in Spanish: "Pendiente", "Aprobado", "Rechazado"
  - [x] Export component as default export

- [x] **Task 4: Create Incidents List Page** (AC: 1, 2, 3, 4, 6, 7, 8, 9, 10)
  - [x] Create file `/src/app/(dashboard)/dashboard/incidents/page.tsx`
  - [x] Mark as client component with `"use client"` directive
  - [x] Import `useEffect`, `useState` from React
  - [x] Import `getIncidents` from API client
  - [x] Import `useRouter` from `next/navigation`
  - [x] Define state: `incidents: Incident[]`, `loading: boolean`, `error: string | null`
  - [x] Fetch incidents on component mount using `useEffect`
  - [x] Handle loading state: display `LoadingSpinner` component
  - [x] Handle error state: display error message in red text
  - [x] Handle empty state: display "No se encontraron incidentes"
  - [x] Render page with title "Incidentes Reportados"

- [x] **Task 5: Implement Incident Table Display** (AC: 4, 5, 10)
  - [x] Use shadcn/ui `Table` component for incident list
  - [x] Create table headers: "ID", "Título", "Categoría", "Fecha de Creación", "Estado"
  - [x] Map over incidents array to render table rows
  - [x] Display ID as numeric value
  - [x] Truncate título to 50 characters with ellipsis using CSS: `className="truncate max-w-[200px]"`
  - [x] Display category title (for now, use `id_categoria` as placeholder - will be enhanced in Story 2.3)
  - [x] Format `fecha_creacion` as "DD/MM/YYYY HH:mm" using date formatting utility
  - [x] Render `IncidentStatusBadge` component for status column
  - [x] Make each row clickable: on click, navigate to `/dashboard/incidents/[id]`

- [x] **Task 6: Create Date Formatting Utility** (AC: 4)
  - [x] Create file `/src/lib/utils/formatters.ts` (if not exists)
  - [x] Create `formatDateTime(date: string | Date): string` function
  - [x] Parse date string and format as "DD/MM/YYYY HH:mm"
  - [x] Handle invalid dates gracefully (return "Fecha no disponible")
  - [x] Export function

- [x] **Task 7: Implement Basic Pagination** (AC: 6)
  - [x] Add state: `currentPage: number`, `itemsPerPage: number` (default 50)
  - [x] Calculate `startIndex` and `endIndex` for current page
  - [x] Slice incidents array to display only current page items
  - [x] Create pagination controls: "Anterior" (Previous) and "Siguiente" (Next) buttons
  - [x] Disable "Anterior" button on first page
  - [x] Disable "Siguiente" button on last page
  - [x] Display page info: "Página X de Y"
  - [x] Use shadcn/ui `Button` component for pagination controls

- [x] **Task 8: Add Search Bar and Filter Placeholders** (AC: 2)
  - [x] Import `Input` component from shadcn/ui
  - [x] Add search input with placeholder: "Buscar por ID, título, descripción, o palabras clave..."
  - [x] Add filter dropdown placeholder (disabled, will be implemented in Story 2.3)
  - [x] Position search bar and filters at top of page above incident table
  - [x] Use Tailwind CSS for layout: flex container with gap

- [x] **Task 9: Create LoadingSpinner Component** (AC: 7)
  - [x] Check if `/src/components/common/LoadingSpinner.tsx` exists (created in Story 1.7)
  - [x] If not exists, create component with `Loader2` icon from `lucide-react`
  - [x] Add `animate-spin` class for rotation animation
  - [x] Center spinner vertically and horizontally
  - [x] Export component as default export

- [x] **Task 10: Write Unit Tests for Incident Type and API Client** (AC: 3)
  - [x] Create test file `/src/lib/api/incidents.test.ts`
  - [x] Test: `getIncidents()` returns array of incidents
  - [x] Test: `getIncidents()` handles API errors gracefully
  - [x] Mock `api.get` using Vitest `vi.mock()`
  - [x] Verify correct endpoint is called: `/admin/incidents/list`
  - [x] Run tests: `npm run test`

- [x] **Task 11: Verification and Manual Testing** (AC: All)
  - [x] Navigate to `/dashboard/incidents` in browser
  - [x] Verify page title "Incidentes Reportados" displays
  - [x] Verify loading spinner shows while fetching data
  - [x] Verify incidents display in table format with all required columns
  - [x] Verify status badges are color-coded correctly
  - [x] Verify date formatting is correct (DD/MM/YYYY HH:mm)
  - [x] Verify pagination controls work correctly
  - [x] Test clicking on incident row navigates to detail page
  - [x] Test empty state by clearing backend data
  - [x] Test error state by stopping backend API
  - [x] Run `npm run lint` to ensure no ESLint errors
  - [x] Run `npm run build` to verify production build succeeds

---

## Dev Notes

### Previous Story Insights

**Key Learnings from Story 1.7 (Protected Route Guard)** [Source: docs/stories/1.7.story.md]
- All routes under `/dashboard/*` are protected by `ProtectedRoute` component
- Dashboard layout at `/src/app/(dashboard)/layout.tsx` wraps content with auth check
- LoadingSpinner component created at `/src/components/common/LoadingSpinner.tsx`
- Auth context provides `isAuthenticated`, `isLoading`, `user` state
- Protected routes redirect to `/login?returnTo=<current-path>` if not authenticated

**Important Coordination**:
- This story creates the first major feature page within the protected dashboard
- Incident list page will inherit authentication protection from dashboard layout
- Future stories (2.2 - 2.7) will build upon this foundation with search, filters, and detail views

---

### Backend API Specifications

**Incident List Endpoint** [Source: docs/prd/epic-2-incident-management-system.md#Story 2.1, AC3]

```typescript
// API Endpoint: GET /admin/incidents/list
// Returns: Array of incident objects

// Expected Response Structure (inferred from database schema and requirements):
interface IncidentResponse {
  id: number;
  titulo: string;
  descripcion: string;
  id_categoria: number;
  id_estatus: number; // 1 = Pendiente, 2 = Aprobado, 3 = Rechazado
  nombre_atacante: string | null;
  telefono: string | null;
  correo_electronico_atacante: string | null;
  usuario_red_social: string | null;
  red_social: string | null;
  id_usuario: number;
  fecha_creacion: string; // ISO 8601 date string
  fecha_actualizacion: string; // ISO 8601 date string
  supervisor: number | null; // Admin user ID
  es_anonimo: boolean;
}

// API Call Pattern (using existing api client):
import { api } from '@/lib/api/client';

const response = await api.get('/admin/incidents/list');
const incidents: IncidentResponse[] = response.data;
```

**Authentication Requirements** [Source: docs/prd/technical-assumptions.md#Backend API Assumptions]
- All `/admin/*` endpoints require JWT authentication
- Token automatically injected by API client interceptor [Source: src/lib/api/client.ts:31-46]
- 401 Unauthorized responses trigger automatic redirect to login

---

### Data Models and Type Definitions

**Incident Status Enum** [Source: docs/prd/epic-2-incident-management-system.md#Story 2.1, AC5]

```typescript
// /src/lib/types/incident.types.ts

export enum IncidentStatus {
  Pendiente = 1,
  Aprobado = 2,
  Rechazado = 3
}

export interface Incident {
  id: number;
  titulo: string;
  descripcion: string;
  id_categoria: number;
  id_estatus: IncidentStatus;
  nombre_atacante: string | null;
  telefono: string | null;
  correo_electronico_atacante: string | null;
  usuario_red_social: string | null;
  red_social: string | null;
  id_usuario: number;
  fecha_creacion: string; // ISO 8601 date string
  fecha_actualizacion: string; // ISO 8601 date string
  supervisor: number | null; // Admin user ID
  es_anonimo: boolean;
}
```

**Status Badge Color Mapping** [Source: docs/prd/epic-2-incident-management-system.md#Story 2.1, AC5]
- Pendiente (1): Yellow/Amber - `bg-yellow-100 text-yellow-800`
- Aprobado (2): Green - `bg-green-100 text-green-800`
- Rechazado (3): Red - `bg-red-100 text-red-800`

---

### File Locations and Project Structure

**New Files to Create** [Source: docs/architecture/source-tree.md]

```
src/
├── lib/
│   ├── types/
│   │   └── incident.types.ts         # NEW: Incident data model types
│   ├── api/
│   │   └── incidents.ts               # NEW: Incident API client functions
│   └── utils/
│       └── formatters.ts              # NEW: Date/time formatting utilities
├── components/
│   └── incidents/
│       └── IncidentStatusBadge.tsx    # NEW: Status badge component
├── app/
│   └── (dashboard)/
│       └── incidents/
│           └── page.tsx               # NEW: Incident list page
```

**Existing Files to Reference**:
- `/src/lib/api/client.ts` - Axios client with JWT token injection [Source: src/lib/api/client.ts]
- `/src/components/common/LoadingSpinner.tsx` - Loading indicator [Source: docs/stories/1.7.story.md:74-80]
- `/src/app/(dashboard)/layout.tsx` - Protected dashboard layout [Source: docs/stories/1.7.story.md:374-397]

**Route Structure** [Source: docs/architecture/source-tree.md#/src/app]
```
src/app/
├── (dashboard)/                     # Protected routes
│   └── incidents/
│       ├── page.tsx                 # NEW: Incident list page (/dashboard/incidents)
│       └── [id]/
│           └── page.tsx             # Future: Incident detail page (Story 2.4)
```

---

### shadcn/ui Components to Use

**Table Component** [Source: docs/architecture/tech-stack.md#shadcn/ui]

```typescript
// Install if not already added:
// npx shadcn@latest add table

import {
  Table,
  TableBody,
  TableCell,
  TableHead,
  TableHeader,
  TableRow,
} from "@/components/ui/table";

// Usage:
<Table>
  <TableHeader>
    <TableRow>
      <TableHead>ID</TableHead>
      <TableHead>Título</TableHead>
      <TableHead>Categoría</TableHead>
      <TableHead>Fecha de Creación</TableHead>
      <TableHead>Estado</TableHead>
    </TableRow>
  </TableHeader>
  <TableBody>
    {incidents.map((incident) => (
      <TableRow key={incident.id} onClick={() => handleRowClick(incident.id)} className="cursor-pointer hover:bg-gray-50">
        <TableCell>{incident.id}</TableCell>
        <TableCell className="truncate max-w-[200px]">{incident.titulo}</TableCell>
        {/* ... more cells */}
      </TableRow>
    ))}
  </TableBody>
</Table>
```

**Badge Component** [Source: docs/architecture/tech-stack.md#shadcn/ui]

```typescript
// Install if not already added:
// npx shadcn@latest add badge

import { Badge } from "@/components/ui/badge";

// Usage in IncidentStatusBadge component:
<Badge className={cn(
  statusColors[status]
)}>
  {statusLabels[status]}
</Badge>
```

**Button Component** [Source: docs/architecture/tech-stack.md#shadcn/ui]

```typescript
// Already installed (used in previous stories)
import { Button } from "@/components/ui/button";

// Usage for pagination:
<div className="flex items-center justify-between mt-4">
  <Button
    variant="outline"
    onClick={() => setCurrentPage(prev => prev - 1)}
    disabled={currentPage === 1}
  >
    Anterior
  </Button>
  <span>Página {currentPage} de {totalPages}</span>
  <Button
    variant="outline"
    onClick={() => setCurrentPage(prev => prev + 1)}
    disabled={currentPage === totalPages}
  >
    Siguiente
  </Button>
</div>
```

**Input Component** [Source: docs/architecture/tech-stack.md#shadcn/ui]

```typescript
// Install if not already added:
// npx shadcn@latest add input

import { Input } from "@/components/ui/input";

// Usage for search bar placeholder:
<Input
  type="text"
  placeholder="Buscar por ID, título, descripción, o palabras clave..."
  disabled  // Will be implemented in Story 2.2
  className="max-w-md"
/>
```

---

### Date Formatting Utility

**Date Formatting Requirements** [Source: docs/prd/epic-2-incident-management-system.md#Story 2.1, AC4]

```typescript
// /src/lib/utils/formatters.ts

/**
 * Format a date string or Date object to "DD/MM/YYYY HH:mm" format
 * @param date - ISO 8601 date string or Date object
 * @returns Formatted date string in Spanish format
 */
export function formatDateTime(date: string | Date): string {
  try {
    const dateObj = typeof date === 'string' ? new Date(date) : date;

    if (isNaN(dateObj.getTime())) {
      return 'Fecha no disponible';
    }

    const day = String(dateObj.getDate()).padStart(2, '0');
    const month = String(dateObj.getMonth() + 1).padStart(2, '0');
    const year = dateObj.getFullYear();
    const hours = String(dateObj.getHours()).padStart(2, '0');
    const minutes = String(dateObj.getMinutes()).padStart(2, '0');

    return `${day}/${month}/${year} ${hours}:${minutes}`;
  } catch {
    return 'Fecha no disponible';
  }
}
```

**Why Not Use a Library?** [Source: docs/architecture/tech-stack.md#Future Considerations]
- MVP uses native JavaScript Date formatting to minimize dependencies
- Post-MVP: Consider `date-fns` or `Day.js` for more complex date operations
- Current requirements are simple enough for native implementation

---

### Pagination Logic

**Pagination Implementation** [Source: docs/prd/epic-2-incident-management-system.md#Story 2.1, AC6]

```typescript
// State management for pagination
const [currentPage, setCurrentPage] = useState(1);
const itemsPerPage = 50; // Default from requirements

// Calculate pagination values
const totalPages = Math.ceil(incidents.length / itemsPerPage);
const startIndex = (currentPage - 1) * itemsPerPage;
const endIndex = startIndex + itemsPerPage;
const currentIncidents = incidents.slice(startIndex, endIndex);

// Render current page items
{currentIncidents.map((incident) => (
  // Render incident row
))}

// Pagination controls
<Button
  onClick={() => setCurrentPage(prev => prev - 1)}
  disabled={currentPage === 1}
>
  Anterior
</Button>
<Button
  onClick={() => setCurrentPage(prev => prev + 1)}
  disabled={currentPage === totalPages}
>
  Siguiente
</Button>
```

**Note**: This is client-side pagination. If backend supports server-side pagination in the future, API will be updated to accept `?page=X&limit=50` query parameters.

---

### Error Handling and Loading States

**Loading State Pattern** [Source: docs/architecture/coding-standards.md#React Component Standards, docs/stories/1.7.story.md]

```typescript
const [loading, setLoading] = useState(true);
const [error, setError] = useState<string | null>(null);

useEffect(() => {
  async function fetchData() {
    try {
      setLoading(true);
      setError(null);
      const data = await getIncidents();
      setIncidents(data);
    } catch (err) {
      setError('Error al cargar incidentes. Intente nuevamente.');
      console.error('Failed to fetch incidents:', err);
    } finally {
      setLoading(false);
    }
  }

  fetchData();
}, []);

// Render logic
if (loading) return <LoadingSpinner />;
if (error) return <div className="text-red-600">{error}</div>;
if (incidents.length === 0) return <div>No se encontraron incidentes</div>;
```

**API Error Handling** [Source: src/lib/api/client.ts:52-129]
- API client interceptor handles 401 (redirects to login), 403, 404, 500 errors
- Network errors display user-friendly Spanish messages
- Component-level try-catch catches remaining errors and displays fallback message

---

### Routing and Navigation

**Next.js Navigation** [Source: docs/architecture/tech-stack.md#Next.js, docs/architecture/coding-standards.md]

```typescript
'use client'; // Required for useRouter

import { useRouter } from 'next/navigation';

export default function IncidentsPage() {
  const router = useRouter();

  const handleRowClick = (incidentId: number) => {
    router.push(`/dashboard/incidents/${incidentId}`);
  };

  return (
    <TableRow
      key={incident.id}
      onClick={() => handleRowClick(incident.id)}
      className="cursor-pointer hover:bg-gray-50"
    >
      {/* Table cells */}
    </TableRow>
  );
}
```

**Route Protection** [Source: docs/stories/1.7.story.md#Dashboard Layout Structure]
- `/dashboard/incidents` is automatically protected by `(dashboard)` layout
- No additional authentication logic needed in page component
- User must be logged in to access this route

---

### Styling and CSS Standards

**Tailwind CSS Conventions** [Source: docs/architecture/coding-standards.md#Styling Standards]

```typescript
// Truncate long titles with ellipsis
<TableCell className="truncate max-w-[200px]">{incident.titulo}</TableCell>

// Clickable table row with hover effect
<TableRow className="cursor-pointer hover:bg-gray-50">

// Error message styling
<div className="text-red-600 font-medium">{error}</div>

// Page layout container
<div className="container mx-auto py-6">
  <h1 className="text-2xl font-bold mb-6">Incidentes Reportados</h1>
  {/* Content */}
</div>
```

**Component Class Names** [Source: docs/architecture/coding-standards.md#Component Class Names]
- Accept `className` prop for flexibility in parent components
- Use `cn()` utility from shadcn/ui to merge class names

---

### TypeScript Type Safety

**Type Imports** [Source: docs/architecture/coding-standards.md#TypeScript Standards]

```typescript
import type { Incident, IncidentStatus } from '@/lib/types/incident.types';

// Explicit return types for functions
async function getIncidents(): Promise<Incident[]> {
  const response = await api.get('/admin/incidents/list');
  return response.data;
}

// Component props interface
interface IncidentStatusBadgeProps {
  status: IncidentStatus;
  className?: string;
}
```

**Avoid `any` Type** [Source: docs/architecture/coding-standards.md#Type Safety Rules]
- Use specific types for all variables and function returns
- Leverage TypeScript strict mode for maximum type safety

---

### Coding Standards Compliance

**Import Order** [Source: docs/architecture/coding-standards.md#Import Order]

```typescript
// 1. React and Next.js
import { useState, useEffect } from 'react';
import { useRouter } from 'next/navigation';

// 2. External libraries
// (none for this component)

// 3. Internal utilities and types
import { getIncidents } from '@/lib/api/incidents';
import type { Incident } from '@/lib/types/incident.types';
import { formatDateTime } from '@/lib/utils/formatters';

// 4. Components
import { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from '@/components/ui/table';
import { Button } from '@/components/ui/button';
import LoadingSpinner from '@/components/common/LoadingSpinner';
import IncidentStatusBadge from '@/components/incidents/IncidentStatusBadge';
```

**Naming Conventions** [Source: docs/architecture/coding-standards.md#Naming Conventions]
- Component files: `IncidentStatusBadge.tsx` (PascalCase)
- Utility files: `formatters.ts` (camelCase)
- Hook files: `useIncidents.ts` (camelCase with `use` prefix)
- Boolean variables: `isLoading`, `hasError` (prefix with is/has/should/can)

---

### Testing

**Testing Strategy for This Story** [Source: docs/architecture/tech-stack.md#Testing Stack]

This story implements the first major data fetching and display page. Testing focuses on API integration, data transformation, and UI rendering.

**Test Coverage Requirements**:
- ✅ API client correctly calls `/admin/incidents/list` endpoint
- ✅ Loading state displays spinner during fetch
- ✅ Error state displays error message on API failure
- ✅ Empty state displays when no incidents returned
- ✅ Incidents render in table with correct formatting
- ✅ Status badges display correct colors for each status
- ✅ Date formatting converts ISO 8601 to DD/MM/YYYY HH:mm
- ✅ Pagination controls work correctly
- ✅ Clicking incident row navigates to detail page

**Test Framework** [Source: docs/architecture/tech-stack.md#Testing Stack]
- **Vitest**: Unit testing framework (already configured via Story 1.x)
- **@testing-library/react**: For rendering React components in tests
- **@testing-library/jest-dom**: For DOM matchers

**Test File Locations** [Source: docs/architecture/source-tree.md#Testing Directory Structure]
- Co-locate tests with source files:
  - `/src/lib/api/incidents.test.ts` - API client tests
  - `/src/lib/utils/formatters.test.ts` - Date formatting tests
  - `/src/components/incidents/IncidentStatusBadge.test.tsx` - Badge component tests

**Mock Requirements**:

```typescript
// Mock API client
vi.mock('@/lib/api/client', () => ({
  api: {
    get: vi.fn(),
  },
}));

// Mock Next.js router
vi.mock('next/navigation', () => ({
  useRouter: () => ({
    push: vi.fn(),
  }),
}));

// Mock data
const mockIncidents: Incident[] = [
  {
    id: 1,
    titulo: 'Test incident',
    descripcion: 'Test description',
    id_categoria: 1,
    id_estatus: IncidentStatus.Pendiente,
    nombre_atacante: 'John Doe',
    telefono: '555-1234',
    correo_electronico_atacante: 'attacker@example.com',
    usuario_red_social: '@attacker',
    red_social: 'Twitter',
    id_usuario: 1,
    fecha_creacion: '2025-10-06T10:30:00Z',
    fecha_actualizacion: '2025-10-06T10:30:00Z',
    supervisor: null,
    es_anonimo: false,
  },
];
```

**Manual Testing Scenarios**:

1. **Data Fetching**:
   - Navigate to `/dashboard/incidents`
   - Verify loading spinner displays briefly
   - Verify incidents load and display in table
   - Check browser DevTools Network tab: verify `GET /admin/incidents/list` called

2. **Table Display**:
   - Verify all columns display: ID, Título, Categoría, Fecha de Creación, Estado
   - Verify títulos longer than 50 chars show ellipsis
   - Verify dates formatted as DD/MM/YYYY HH:mm
   - Verify status badges show correct colors

3. **Pagination**:
   - If more than 50 incidents, verify "Siguiente" button enabled
   - Click "Siguiente" → verify next page of incidents displays
   - Verify "Anterior" button disabled on first page
   - Verify "Siguiente" button disabled on last page

4. **Navigation**:
   - Click on incident row
   - Verify navigation to `/dashboard/incidents/[id]`
   - Note: Detail page will show 404 until Story 2.4 is implemented

5. **Edge Cases**:
   - Empty state: Clear backend database → verify "No se encontraron incidentes" displays
   - Error state: Stop backend API → verify error message displays
   - Authentication: Logout → verify redirect to `/login?returnTo=/dashboard/incidents`

6. **Build Verification**:
   - Run `npm run lint` → ensure no errors
   - Run `npm run build` → ensure production build succeeds
   - Run `npm run test` → ensure all tests pass

---

## Change Log

| Date       | Version | Description                      | Author        |
|------------|---------|----------------------------------|---------------|
| 2025-10-06 | 1.0     | Initial story draft created      | Bob (SM)      |
| 2025-10-06 | 1.1     | Story implementation completed   | James (Dev)   |

---

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4.5 (claude-sonnet-4-5-20250929)

### Debug Log References

None - All tasks completed successfully without debugging issues.

### Completion Notes

All 11 tasks completed successfully:

1. **Type Definitions**: Created comprehensive Incident and IncidentStatus types with full documentation
2. **API Client**: Implemented getIncidents() function with proper error handling
3. **Status Badge**: Created reusable color-coded badge component for incident statuses
4. **Date Formatter**: Implemented formatDateTime() utility with graceful error handling
5. **Incidents Page**: Built full-featured page with loading/error/empty states
6. **Table Display**: Implemented responsive table with all required columns and click navigation
7. **Pagination**: Added client-side pagination with 50 items per page
8. **Search Placeholder**: Added disabled search bar for future implementation
9. **Tests**: Created comprehensive unit tests for API client, formatters, and badge component
10. **Verification**: All tests pass, linting clean, production build successful

**Key Implementation Decisions**:
- Used client-side pagination (50 items/page) as backend doesn't support server-side pagination yet
- Category displayed as ID number for now (will be enhanced with category names in Story 2.3)
- Search bar disabled as placeholder (functionality in Story 2.2)
- All shadcn/ui components (Table, Badge, Button, Input) were already installed
- LoadingSpinner component already existed from Story 1.7

**Testing Results**:
- ✓ All new unit tests pass (10 tests total)
- ✓ ESLint: No warnings or errors
- ✓ Build: Production build successful
- ✓ Route generated: /dashboard/incidents (4.61 kB)

### File List

**New Files Created**:
- `src/lib/types/incident.types.ts` - Incident data type definitions
- `src/lib/api/incidents.ts` - Incident API client functions
- `src/lib/utils/formatters.ts` - Date formatting utilities
- `src/components/incidents/IncidentStatusBadge.tsx` - Status badge component
- `src/app/(dashboard)/dashboard/incidents/page.tsx` - Incidents list page
- `src/lib/api/incidents.test.ts` - API client tests
- `src/lib/utils/formatters.test.ts` - Formatter utility tests
- `src/components/incidents/IncidentStatusBadge.test.tsx` - Badge component tests

**Directories Created**:
- `src/lib/utils/` - Utility functions directory
- `src/components/incidents/` - Incident-specific components
- `src/app/(dashboard)/dashboard/incidents/` - Incidents route directory

---

## QA Results

_This section will be populated by the QA agent after story completion._
