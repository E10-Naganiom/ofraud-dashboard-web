# Story 1.6: Admin Login Page

<!-- Powered by BMAD™ Core -->

## Status
Done

---

## Story

**As an** administrator,
**I want** to log in with my email and password,
**so that** I can access the admin dashboard and manage the platform.

---

## Acceptance Criteria

1. Login page created at `/login` route
2. Form displays fields: Correo (email), Contraseña (password)
3. Form validation using React Hook Form + Zod:
   - Correo: required, valid email format
   - Contraseña: required, min 8 characters
4. Client-side validation displays inline error messages:
   - "Campo de Correo/Contraseña obligatorio"
   - "Correo electrónico inválido"
5. Submit button disabled until form is valid
6. On submit, calls API client `loginAdmin()` function (`POST /auth/login`)
7. API success response:
   - JWT token and user object stored in auth context via `login()` function
   - Toast displayed: "¡Inicio de sesión exitoso! Bienvenido [NOMBRE]"
   - User redirected to `/dashboard` (home page)
8. API error responses handled:
   - 404 Not Found: "Usuario no encontrado"
   - 401 Unauthorized: "Contraseña incorrecta"
   - 400 Bad Request: "Correo electrónico inválido"
9. Loading state shown during API call
10. Link to "¿No tienes cuenta? Regístrate" navigates to `/register`
11. If user is already authenticated (token exists), redirect to `/dashboard` immediately

---

## Tasks / Subtasks

- [x] **Task 1: Create Zod Validation Schema for Login Form** (AC: 3, 4)
  - [x] Add `loginSchema` to existing `/src/lib/validations/auth.schema.ts`
  - [x] Define schema with Zod:
    - `correo`: `z.string().min(1, "Campo de Correo obligatorio").email("Correo electrónico inválido")`
    - `contrasena`: `z.string().min(8, "Campo de Contraseña obligatorio")`
  - [x] Export `loginSchema` and infer type `LoginFormData` using `z.infer<typeof loginSchema>`

- [x] **Task 2: Create Login Page Route** (AC: 1)
  - [x] Create file `/src/app/(auth)/login/page.tsx`
  - [x] Set up basic page structure with "use client" directive (client component for form and auth check)
  - [x] Import necessary dependencies: React Hook Form, Zod resolver, shadcn/ui components, useAuth hook
  - [x] Add page metadata (title: "Inicio de Sesión - oFraud Admin")

- [x] **Task 3: Implement Authentication Check on Page Load** (AC: 11)
  - [x] Import `useAuth()` hook from AuthContext
  - [x] Access `isAuthenticated` and `isLoading` from auth context
  - [x] Show loading spinner while `isLoading` is true
  - [x] If `isAuthenticated` is true, redirect to `/dashboard` using `router.push('/dashboard')`
  - [x] Only render login form if not authenticated

- [x] **Task 4: Build Login Form UI** (AC: 2, 10)
  - [x] Use shadcn/ui `Form`, `FormField`, `FormItem`, `FormLabel`, `FormControl`, `FormMessage` components
  - [x] Add form fields in order:
    1. **Correo** (email input)
    2. **Contraseña** (password input)
  - [x] Add submit button (shadcn/ui `Button` component)
  - [x] Add link at bottom: "¿No tienes cuenta? Regístrate" → navigates to `/register` using Next.js `Link`
  - [x] Add page title/header: "Iniciar Sesión" or similar
  - [x] Style form with Tailwind CSS (centered card layout, responsive)

- [x] **Task 5: Integrate React Hook Form with Zod** (AC: 3, 4, 5)
  - [x] Initialize `useForm` hook with:
    - `resolver: zodResolver(loginSchema)`
    - `mode: "onChange"` (for real-time validation)
    - `defaultValues`: empty strings for all fields
  - [x] Connect form fields to React Hook Form using `Controller` or field registration
  - [x] Display validation errors using `FormMessage` below each field
  - [x] Disable submit button when form has errors: `disabled={!formState.isValid || isSubmitting}`
  - [x] Access form state: `const { formState: { errors, isValid, isSubmitting } } = useForm()`

- [x] **Task 6: Implement Form Submission Handler** (AC: 6, 7, 8, 9)
  - [x] Create `onSubmit` handler function:
    - Accept `data: LoginFormData` parameter
    - Set loading state: `setIsSubmitting(true)`
    - Call `loginAdmin()` from `@/lib/api/auth`
  - [x] On success (200/201 response):
    - Extract `access_token` and `user` from response
    - Call `login(access_token, user)` from auth context
    - Display toast notification: `toast.success(\`¡Inicio de sesión exitoso! Bienvenido ${user.nombre}\`)`
    - Redirect to `/dashboard` using `router.push('/dashboard')`
  - [x] On error:
    - Catch Axios error
    - Check `error.response?.status`:
      - `404`: Display "Usuario no encontrado"
      - `401`: Display "Contraseña incorrecta"
      - `400`: Display "Correo electrónico inválido"
      - Other: Display generic error message "Error al iniciar sesión. Por favor, intente nuevamente."
    - Show error toast: `toast.error(errorMessage)`
  - [x] Always set loading state to false in `finally` block

- [x] **Task 7: Add Loading State UI** (AC: 9)
  - [x] While `isSubmitting` is true:
    - Disable all form fields
    - Show spinner icon in submit button
    - Change button text to "Iniciando sesión..." or show spinner with lucide-react `Loader2` icon
  - [x] Use `disabled={isSubmitting}` on all form inputs
  - [x] Example button: `<Button disabled={isSubmitting}>{isSubmitting ? <Loader2 className="animate-spin" /> : "Iniciar Sesión"}</Button>`

- [x] **Task 8: Configure Toast Notifications** (AC: 7, 8)
  - [x] Ensure `Toaster` component from `sonner` is added to root layout (should exist from Story 1.2/1.5)
  - [x] Import `toast` from `sonner` in login page
  - [x] Use `toast.success()` and `toast.error()` for success/error notifications

- [x] **Task 9: Add Client-Side Navigation** (AC: 7, 10, 11)
  - [x] Import `useRouter` from `next/navigation`
  - [x] Import `Link` from `next/link`
  - [x] After successful login, redirect: `router.push('/dashboard')`
  - [x] If already authenticated on page load, redirect: `router.push('/dashboard')`
  - [x] Add link at bottom of form: `<Link href="/register">¿No tienes cuenta? Regístrate</Link>`

- [x] **Task 10: Style Login Page** (AC: 2)
  - [x] Create centered card layout (use shadcn/ui `Card` component)
  - [x] Add page background (light gray or gradient, match registration page)
  - [x] Ensure responsive design (mobile-friendly)
  - [x] Add spacing between form fields (Tailwind `space-y-4`)
  - [x] Style inputs with proper focus states (shadcn/ui default styles)
  - [x] Add form title and description above form

- [x] **Task 11: Write Unit Tests for Login Form** (AC: All)
  - [x] Create test file `/src/app/(auth)/login/page.test.tsx`
  - [x] Test: Form renders with all required fields (Correo, Contraseña)
  - [x] Test: Validation errors display for empty fields
  - [x] Test: Email validation works (invalid email shows error)
  - [x] Test: Password validation works (min length)
  - [x] Test: Submit button is disabled when form is invalid
  - [x] Test: Successful login calls API, updates auth context, and redirects to `/dashboard`
  - [x] Test: 404 error displays "Usuario no encontrado"
  - [x] Test: 401 error displays "Contraseña incorrecta"
  - [x] Test: 400 error displays "Correo electrónico inválido"
  - [x] Test: If already authenticated, redirects to `/dashboard` immediately
  - [x] Run tests: `npm run test`

- [x] **Task 12: Verification and Testing** (AC: All)
  - [x] Manually test login flow:
    - Submit empty form → see validation errors
    - Enter invalid email → see email error
    - Enter short password → see password error
    - Enter valid credentials → see loading state → success toast with user name → redirect to dashboard
  - [x] Test error scenarios:
    - Simulate 404 error (user not found) → verify Spanish error message
    - Simulate 401 error (wrong password) → verify Spanish error message
    - Simulate 400 error (invalid email) → verify Spanish error message
  - [x] Test authentication check:
    - Login successfully
    - Navigate to `/login` again → should redirect to `/dashboard` immediately
  - [x] Run `npm run lint` to ensure no ESLint errors
  - [x] Run `npm run build` to verify production build succeeds
  - [x] Test on mobile viewport (responsive design)

---

## Dev Notes

### Previous Story Insights

**Key Learnings from Story 1.5 (Admin Registration Page)** [Source: docs/stories/1.5.story.md#Dev Agent Record]
- Registration form successfully implemented with React Hook Form + Zod validation
- Form validation schema pattern established in `/src/lib/validations/auth.schema.ts`
- shadcn/ui Form components pattern proven and working well
- Toast notifications configured with Sonner in root layout
- Centered card layout pattern works well for auth pages
- Spanish error messages maintained throughout
- Loading states implemented with spinner in button
- Login page will follow similar patterns and UI design

**Key Learnings from Story 1.4 (AuthContext)** [Source: docs/stories/1.4.story.md]
- AuthContext provides `login(token, user)` function for storing auth state
- Context available via `useAuth()` hook
- Token automatically saved to localStorage by `login()` function
- `isAuthenticated` and `isLoading` state available for checking auth status
- Login page should use `login()` from AuthContext after successful API call
- AuthContext wraps entire app in root layout

**Key Learnings from Story 1.3 (API Client)** [Source: docs/stories/1.3.story.md]
- API client configured in `/src/lib/api/client.ts` using Axios
- `loginAdmin()` function available in `/src/lib/api/auth.ts`
- `loginAdmin()` expects: `{ correo: string, contrasena: string }`
- `loginAdmin()` returns: `{ access_token: string, user: { id, nombre, correo, is_admin } }`
- POST request endpoint: `/auth/login`
- Response status: 200 OK on success
- Error responses:
  - 404 Not Found: User doesn't exist
  - 401 Unauthorized: Wrong password
  - 400 Bad Request: Validation errors (invalid email format)
- Error messages from backend may be in English - frontend displays Spanish messages

**Important Coordination**:
- This login page is the entry point for registered admins
- After successful login, user is redirected to `/dashboard` (not yet implemented, but route should work)
- If user is already authenticated, they should be redirected immediately
- Login page complements registration page (Story 1.5)

---

### Form Validation Architecture

**React Hook Form + Zod Integration** [Source: docs/architecture/tech-stack.md#State Management]
- **React Hook Form**: Installed (`react-hook-form` v7.64.0)
- **Zod**: Installed (`zod` v4.1.11)
- **@hookform/resolvers**: Installed (v5.2.2) for Zod integration
- **Why Zod?**: TypeScript-first validation, type inference, mirrors backend DTOs
- **Why React Hook Form?**: Minimal re-renders, excellent performance, TypeScript support

**Validation Schema Pattern** [Source: docs/architecture/coding-standards.md#TypeScript Standards]
```typescript
// src/lib/validations/auth.schema.ts
import { z } from 'zod';

// Add to existing file after registerSchema
export const loginSchema = z.object({
  correo: z
    .string()
    .min(1, "Campo de Correo obligatorio")
    .email("Correo electrónico inválido"),
  contrasena: z
    .string()
    .min(8, "Campo de Contraseña obligatorio")
});

// Infer TypeScript type from schema
export type LoginFormData = z.infer<typeof loginSchema>;
```

**Form Hook Setup**:
```typescript
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { loginSchema, type LoginFormData } from '@/lib/validations/auth.schema';

const form = useForm<LoginFormData>({
  resolver: zodResolver(loginSchema),
  mode: 'onChange', // Validate on every change for real-time feedback
  defaultValues: {
    correo: '',
    contrasena: '',
  },
});
```

---

### Authentication Context Integration

**Auth Context API** [Source: src/contexts/AuthContext.tsx]
```typescript
// Import the hook
import { useAuth } from '@/contexts/AuthContext';

// Usage in Login page component
const { login, isAuthenticated, isLoading } = useAuth();

// After successful login API call
const response = await loginAdmin(formData);
login(response.access_token, response.user);
```

**Auth Context State** [Source: src/lib/types/auth.types.ts]
- `user: AdminUser | null` - Current logged-in user
- `token: string | null` - JWT access token
- `isAuthenticated: boolean` - Whether user is logged in
- `isLoading: boolean` - Whether auth state is being initialized

**Auth Context Methods**:
- `login(token: string, user: AdminUser): void` - Stores token in localStorage and updates state
- `logout(): void` - Clears token and auth state
- `register(userData): Promise<void>` - Registers new user (not used in login page)

---

### File Locations and Project Structure

**New Files to Create** [Source: docs/architecture/source-tree.md]
```
src/
├── app/
│   └── (auth)/                     # Route group for auth pages
│       └── login/
│           └── page.tsx            # NEW: Login page
├── lib/
│   └── validations/
│       └── auth.schema.ts          # UPDATE: Add loginSchema (existing file)
```

**Existing Files to Use**:
- `/src/lib/api/auth.ts` - `loginAdmin()` function (Story 1.3) [Source: src/lib/api/auth.ts]
- `/src/lib/api/client.ts` - Axios client instance (Story 1.3)
- `/src/lib/types/auth.types.ts` - `LoginAdminRequest`, `LoginAdminResponse`, `AdminUser` (Story 1.3) [Source: src/lib/types/auth.types.ts]
- `/src/contexts/AuthContext.tsx` - Auth context with `login()` function (Story 1.4) [Source: src/contexts/AuthContext.tsx]
- `/src/components/ui/*` - shadcn/ui components (Button, Input, Form, Card, etc.) (Story 1.2)
- `/src/app/layout.tsx` - Root layout with Toaster component (Story 1.2)
- `/src/lib/validations/auth.schema.ts` - Existing validation schema file (Story 1.5) [Source: src/lib/validations/auth.schema.ts]

**Route Structure** [Source: docs/architecture/source-tree.md#/src/app]
- Route: `/login` (no `/auth` prefix in URL)
- File path: `/src/app/(auth)/login/page.tsx`
- Route group `(auth)` does not affect URL but allows separate layout if needed

---

### shadcn/ui Form Components

**Form Components Available** [Source: docs/architecture/tech-stack.md#shadcn/ui]
All shadcn/ui components are installed in `/src/components/ui/`:
- `Form`, `FormField`, `FormItem`, `FormLabel`, `FormControl`, `FormMessage`, `FormDescription`
- `Input` (text, email, password inputs)
- `Button`
- `Card`, `CardHeader`, `CardContent`, `CardFooter`
- `Label`

**Form Component Pattern** [Source: docs/architecture/coding-standards.md#React Component Standards]
```typescript
import { Form, FormField, FormItem, FormLabel, FormControl, FormMessage } from '@/components/ui/form';
import { Input } from '@/components/ui/input';
import { Button } from '@/components/ui/button';

<Form {...form}>
  <form onSubmit={form.handleSubmit(onSubmit)} className="space-y-4">
    <FormField
      control={form.control}
      name="correo"
      render={({ field }) => (
        <FormItem>
          <FormLabel>Correo Electrónico</FormLabel>
          <FormControl>
            <Input type="email" placeholder="correo@ejemplo.com" {...field} />
          </FormControl>
          <FormMessage /> {/* Displays validation error automatically */}
        </FormItem>
      )}
    />

    <FormField
      control={form.control}
      name="contrasena"
      render={({ field }) => (
        <FormItem>
          <FormLabel>Contraseña</FormLabel>
          <FormControl>
            <Input type="password" placeholder="••••••••" {...field} />
          </FormControl>
          <FormMessage />
        </FormItem>
      )}
    />

    <Button type="submit" disabled={!form.formState.isValid || isSubmitting}>
      {isSubmitting ? <Loader2 className="animate-spin" /> : "Iniciar Sesión"}
    </Button>
  </form>
</Form>
```

---

### Toast Notifications

**Toast Library: Sonner** [Source: docs/architecture/tech-stack.md#UI Components]
- Installed: `sonner` (v2.0.7)
- Import: `import { toast } from 'sonner'`
- Usage:
  - Success: `toast.success(\`¡Inicio de sesión exitoso! Bienvenido ${user.nombre}\`)`
  - Error: `toast.error("Usuario no encontrado")`
- Position: `top-right` (configured in root layout)

**Toaster Component** [Source: docs/stories/1.2.story.md]
- Already added to `/src/app/layout.tsx` in Story 1.2/1.5
- No additional setup needed

---

### Error Handling

**API Error Response Format** [Source: docs/stories/1.3.story.md#Dev Notes]
```typescript
// 404 Not Found (user doesn't exist)
{
  statusCode: 404,
  message: "User not found",
  error: "Not Found"
}

// 401 Unauthorized (wrong password)
{
  statusCode: 401,
  message: "Invalid credentials",
  error: "Unauthorized"
}

// 400 Bad Request (validation errors)
{
  statusCode: 400,
  message: "Invalid email format",
  error: "Bad Request"
}
```

**Frontend Error Handling**:
```typescript
const onSubmit = async (data: LoginFormData) => {
  try {
    setIsSubmitting(true);

    const response = await loginAdmin(data);

    // Store auth state
    login(response.access_token, response.user);

    // Show success message
    toast.success(`¡Inicio de sesión exitoso! Bienvenido ${response.user.nombre}`);

    // Redirect to dashboard
    router.push('/dashboard');

  } catch (error) {
    if (axios.isAxiosError(error)) {
      const status = error.response?.status;

      if (status === 404) {
        toast.error("Usuario no encontrado");
      } else if (status === 401) {
        toast.error("Contraseña incorrecta");
      } else if (status === 400) {
        toast.error("Correo electrónico inválido");
      } else {
        toast.error("Error al iniciar sesión. Por favor, intente nuevamente.");
      }
    } else {
      toast.error("Error inesperado. Por favor, intente nuevamente.");
    }
  } finally {
    setIsSubmitting(false);
  }
};
```

**Spanish Error Messages** [Source: Epic 1 Story 1.6 AC#4, AC#8]
- "Campo de Correo obligatorio" (required field)
- "Campo de Contraseña obligatorio" (required field)
- "Correo electrónico inválido" (invalid email format)
- "Usuario no encontrado" (404 error)
- "Contraseña incorrecta" (401 error)
- "Correo electrónico inválido" (400 error)

---

### Page Layout and Styling

**Login Page Layout** [Source: docs/architecture/coding-standards.md#Styling Standards]
```typescript
// Centered card layout with form (match registration page style)
<div className="min-h-screen flex items-center justify-center bg-gray-50">
  <Card className="w-full max-w-md">
    <CardHeader>
      <h1 className="text-2xl font-bold text-center">Iniciar Sesión</h1>
      <p className="text-center text-gray-600">Accede a tu cuenta de administrador</p>
    </CardHeader>
    <CardContent>
      <Form {...form}>
        {/* Form fields */}
      </Form>
    </CardContent>
    <CardFooter className="flex justify-center">
      <p className="text-sm text-gray-600">
        ¿No tienes cuenta?{" "}
        <Link href="/register" className="text-blue-600 hover:underline">
          Regístrate
        </Link>
      </p>
    </CardFooter>
  </Card>
</div>
```

**Responsive Design** [Source: docs/architecture/coding-standards.md#Performance Best Practices]
- Desktop-first for MVP (admin dashboard)
- Mobile-friendly but not mobile-optimized
- Use Tailwind responsive utilities if needed: `sm:`, `md:`, `lg:`
- Max width for form card: `max-w-md` (448px)
- Should match registration page style for consistency

---

### TypeScript Type Safety

**Type Imports** [Source: docs/architecture/coding-standards.md#TypeScript Standards]
```typescript
// Form data type (inferred from Zod schema)
import type { LoginFormData } from '@/lib/validations/auth.schema';

// API types
import type { LoginAdminRequest, LoginAdminResponse } from '@/lib/types/auth.types';

// React Hook Form types
import type { SubmitHandler } from 'react-hook-form';
```

**Type Mapping**:
- `LoginFormData` (from Zod schema) matches `LoginAdminRequest` (API type)
- Both have: `{ correo: string, contrasena: string }`
- Can pass form data directly to API: `await loginAdmin(formData)`

---

### Navigation and Authentication Check

**Next.js Navigation Hooks** [Source: docs/architecture/tech-stack.md#Next.js]
- Import: `import { useRouter } from 'next/navigation'` (App Router)
- Usage: `const router = useRouter(); router.push('/dashboard');`
- Import Link: `import Link from 'next/link'`
- Usage: `<Link href="/register">Regístrate</Link>`

**Authentication Check on Page Load** (AC: 11):
```typescript
'use client';

import { useEffect } from 'react';
import { useRouter } from 'next/navigation';
import { useAuth } from '@/contexts/AuthContext';

export default function LoginPage() {
  const router = useRouter();
  const { isAuthenticated, isLoading } = useAuth();

  useEffect(() => {
    if (!isLoading && isAuthenticated) {
      router.push('/dashboard');
    }
  }, [isAuthenticated, isLoading, router]);

  if (isLoading) {
    return <LoadingSpinner />; // Show loading while checking auth status
  }

  if (isAuthenticated) {
    return null; // Will redirect in useEffect
  }

  return (
    // Render login form
  );
}
```

**After Login Flow**:
1. User submits valid login form
2. API call successful (200 OK)
3. Store token and user in auth context via `login()`
4. Display success toast with user name
5. Redirect to `/dashboard` page

---

### Coding Standards Compliance

**Naming Conventions** [Source: docs/architecture/coding-standards.md#Naming Conventions]
- Component file: `page.tsx` (Next.js convention for routes)
- Validation schema: `loginSchema` (camelCase)
- Type: `LoginFormData` (PascalCase)
- Functions: `onSubmit`, `handleLogin` (camelCase)

**Import Order** [Source: docs/architecture/coding-standards.md#Import Order]
```typescript
// 1. React and Next.js
import { useState, useEffect } from 'react';
import { useRouter } from 'next/navigation';
import Link from 'next/link';

// 2. External libraries
import { useForm } from 'react-hook-form';
import { zodResolver } from '@hookform/resolvers/zod';
import { toast } from 'sonner';
import { Loader2 } from 'lucide-react';
import axios from 'axios';

// 3. Internal utilities and types
import { loginAdmin } from '@/lib/api/auth';
import { loginSchema, type LoginFormData } from '@/lib/validations/auth.schema';
import { useAuth } from '@/contexts/AuthContext';

// 4. Components
import { Form, FormField, FormItem, FormLabel, FormControl, FormMessage } from '@/components/ui/form';
import { Input } from '@/components/ui/input';
import { Button } from '@/components/ui/button';
import { Card, CardHeader, CardContent, CardFooter } from '@/components/ui/card';
```

**Client Component Directive** [Source: docs/architecture/coding-standards.md#Next.js]
- Add `"use client"` at top of file (login page uses hooks and interactivity)

---

### Testing

**Testing Strategy for This Story** [Source: docs/architecture/tech-stack.md#Testing Stack]

This story implements a user-facing login form with client-side validation, authentication integration, and redirect logic. Comprehensive testing ensures form validation, error handling, and auth flow work correctly.

**Test Coverage Requirements**:
- ✅ Form renders with all required fields (Correo, Contraseña)
- ✅ Validation errors display correctly for each field
- ✅ Email validation (valid/invalid formats)
- ✅ Password validation (min length 8 characters)
- ✅ Submit button disabled when form invalid
- ✅ Successful login flow (API call → auth context update → toast → redirect)
- ✅ Error handling (404 Not Found, 401 Unauthorized, 400 Bad Request)
- ✅ Loading state during submission
- ✅ Authentication check (redirect if already logged in)

**Test Framework** [Source: docs/architecture/tech-stack.md#Testing Stack]
- **Vitest**: Unit testing framework (already configured)
- **@testing-library/react**: For rendering React components in tests
- **@testing-library/jest-dom**: For DOM matchers (already installed)
- **@testing-library/user-event**: For simulating user interactions (already installed)

**Test File Location**:
- Co-locate test with component: `/src/app/(auth)/login/page.test.tsx`

**Mock Requirements**:
```typescript
// Mock useRouter from next/navigation
vi.mock('next/navigation', () => ({
  useRouter: () => ({
    push: vi.fn(),
  }),
}));

// Mock toast from sonner
vi.mock('sonner', () => ({
  toast: {
    success: vi.fn(),
    error: vi.fn(),
  },
}));

// Mock loginAdmin API function
vi.mock('@/lib/api/auth', () => ({
  loginAdmin: vi.fn(),
}));

// Mock AuthContext
vi.mock('@/contexts/AuthContext', () => ({
  useAuth: vi.fn(() => ({
    login: vi.fn(),
    isAuthenticated: false,
    isLoading: false,
  })),
}));
```

**Manual Testing**:
1. **Valid Login Flow**:
   - Fill all fields with valid data
   - Submit form
   - Verify loading state (spinner, disabled fields)
   - Verify success toast appears with user name
   - Verify redirect to `/dashboard`

2. **Validation Errors**:
   - Leave fields empty → verify required error messages
   - Enter invalid email → verify email error
   - Enter short password (< 8 chars) → verify password error

3. **API Error Handling**:
   - Trigger 404 error (user not found) → verify Spanish error message
   - Trigger 401 error (wrong password) → verify Spanish error message
   - Trigger 400 error (invalid email) → verify Spanish error message

4. **Authentication Check**:
   - Open `/login` when not logged in → see login form
   - Login successfully → redirect to `/dashboard`
   - Navigate back to `/login` → immediately redirect to `/dashboard` (already authenticated)

5. **Responsive Design**:
   - Test on desktop viewport (1920x1080)
   - Test on tablet viewport (768x1024)
   - Test on mobile viewport (375x667)

**Integration Testing** (Not required for MVP):
- Full end-to-end login with actual backend
- Will be covered in later stories when testing full auth flow

---

## Change Log

| Date       | Version | Description                      | Author        |
|------------|---------|----------------------------------|---------------|
| 2025-10-05 | 1.0     | Initial story draft created      | Bob (SM)      |

---

## Dev Agent Record

### Agent Model Used

Claude Sonnet 4.5 (claude-sonnet-4-5-20250929)

### Debug Log References

No debug log entries required - implementation completed without errors.

### Completion Notes

Successfully implemented the Admin Login Page with all acceptance criteria met:

1. **Zod Validation Schema**: Created `loginSchema` in `/src/lib/validations/auth.schema.ts` with proper validation rules for email and password fields
2. **Login Page Route**: Created `/src/app/(auth)/login/page.tsx` with full authentication flow integration
3. **Authentication Check**: Implemented automatic redirect to `/dashboard` for authenticated users
4. **Form UI**: Built form with shadcn/ui components matching registration page style
5. **Form Validation**: Integrated React Hook Form with Zod for real-time validation
6. **Form Submission**: Implemented complete error handling for 404, 401, 400, and generic errors with Spanish messages
7. **Loading States**: Added loading spinner and disabled states during form submission
8. **Toast Notifications**: Configured success and error toasts using Sonner
9. **Navigation**: Implemented redirect to `/dashboard` on successful login and link to `/register` page
10. **Styling**: Centered card layout with responsive design matching registration page
11. **Unit Tests**: Created comprehensive test suite with 17 tests covering all functionality
12. **Verification**: All tests passing, no ESLint errors, production build successful

**Test Results**:
- 17/17 tests passing
- ESLint: No warnings or errors
- Production build: Successful

**Implementation Notes**:
- Login page follows same design pattern as registration page for UI consistency
- Authentication check implemented with `useEffect` to redirect authenticated users
- Form validation prevents submission with invalid data (client-side)
- Backend error responses properly mapped to Spanish user-facing messages
- All components use TypeScript strict mode with proper type safety

### File List

**Modified Files**:
- `/src/lib/validations/auth.schema.ts` - Added loginSchema and LoginFormData type

**New Files**:
- `/src/app/(auth)/login/page.tsx` - Login page component
- `/src/app/(auth)/login/page.test.tsx` - Unit tests for login page

---

## QA Results

_This section will be populated by the QA agent after story completion._
