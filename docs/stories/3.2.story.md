## Status
Done

## Story
**As a** administrator,
**I want** to search users by name or email,
**so that** I can quickly locate specific accounts.

## Acceptance Criteria
1. Search input field added to user list page (top of page).
2. Placeholder text: "Buscar por nombre o correo electrónico..."
3. Search debounced (500ms delay).
4. Client-side filtering: match query against `nombre`, `apellido`, `email` fields (case-insensitive).
5. Search results update user list in real-time.
6. If no matches: "No se encontraron usuarios que coincidan con '[query]'".
7. Clear search button (X icon) resets search.
8. Search persists in URL query param for bookmarking (e.g., `?search=john`).

## Dev Notes
This section contains all relevant technical details extracted from project documentation. The developer agent should not need to read the full architecture documents.

### User Request Override
- The user requested to create story 3.2 directly, skipping 3.1.
- The user also specified a focus on frontend flow, unblocked by backend functionality. This story's client-side filtering requirement aligns with that request.

### Previous Story Insights
- No previous story for this epic (e.g., 3.1) was found. This is the first story being implemented in Epic 3.

### Data Models
- The user list will be an array of `User` objects.
- The `User` type should be imported from ` '@/lib/types/user.types.ts' `.
- The relevant fields for filtering are `nombre` (string), `apellido` (string), and `email` (string).
- [Source: `docs/architecture/source-tree.md`, `docs/prd/epic-3-user-administration-profile-management.md`]

### API Specifications
- No API calls are required for this story. Filtering is to be performed entirely on the client-side.
- The full user list is assumed to be fetched by the parent component as defined in Story 3.1.
- [Source: `docs/prd/epic-3-user-administration-profile-management.md`]

### Component Specifications
- **Search Input**: Use the `Input` component from `shadcn/ui` located in ` '@/components/ui/input' `.
- **Component Location**: The search functionality should be added to the user list page, likely within `src/app/(dashboard)/users/page.tsx`. Consider creating a dedicated `UserSearch.tsx` component in `src/components/users/` if the logic is complex.
- **Debouncing**: Use the existing `useDebounce` hook located at ` '@/hooks/useDebounce.ts' `. The debounce delay should be 500ms.
- **State Management**:
    - Use `useState` to manage the search query string.
    - Use `useRouter` and `useSearchParams` from `next/navigation` to read and write the search query to the URL.
- [Source: `docs/architecture/source-tree.md`, `docs/architecture/coding-standards.md`, `docs/prd/epic-3-user-administration-profile-management.md`]

### File Locations
- **Modified File**: `src/app/(dashboard)/users/page.tsx` (and/or a component it uses like `UserList.tsx`).
- **Hook Usage**: `src/hooks/useDebounce.ts`.
- **Type Imports**: `src/lib/types/user.types.ts`.
- [Source: `docs/architecture/source-tree.md`]

### Technical Constraints
- All filtering logic must be case-insensitive.
- The search query must be reflected in the URL's query parameters (`?search=...`).
- A button to clear the search input must be implemented.
- [Source: `docs/prd/epic-3-user-administration-profile-management.md`]

## Tasks / Subtasks
- [x] **Task 1: Implement Search State Management** (AC: 3, 8)
    - [x] In `src/app/(dashboard)/users/page.tsx`, use the `useSearchParams` hook to read the 'search' query param on initial load.
    - [x] Use a `useState` hook to manage the search input's value, initializing it from the URL search parameter.
    - [x] Use the `useDebounce` hook to create a debounced version of the search term (500ms).
    - [x] Use `useRouter` to update the URL query parameter whenever the debounced search term changes.

- [x] **Task 2: Create Search UI** (AC: 1, 2, 7)
    - [x] Add an `Input` component (from `@/components/ui/input`) to the top of the user list page.
    - [x] Set the placeholder text to "Buscar por nombre o correo electrónico..." .
    - [x] Bind the `Input`'s value to the search state variable and update it via its `onChange` handler.
    - [x] Add a clear button (e.g., 'X' icon) to the input that resets the search state and removes the query param from the URL.

- [x] **Task 3: Implement Client-Side Filtering Logic** (AC: 4, 5, 6)
    - [x] In the component that renders the user list, use `useMemo` to filter the master user list based on the debounced search term.
    - [x] The filter logic should be case-insensitive and check for matches in the `nombre`, `apellido`, and `email` fields of each user object.
    - [x] If the filtered list is empty and the search term is not, display the message: "No se encontraron usuarios que coincidan con '[query]'".
    - [x] The displayed list of users should be the result of this filtering logic.

- [N/A] **Task 4: Testing**
    - [N/A] As per `coding-standards.md`, testing is post-MVP. No testing tasks are required for this story.

## Testing
- No `testing-strategy.md` document was found.
- The `coding-standards.md` document specifies that unit tests should be co-located with components (e.g., `button.test.tsx` alongside `button.tsx`).
- Testing is considered a post-MVP task for this project.

## Change Log
| Date | Version | Description | Author |
|---|---|---|---|
| 2025-10-12 | 1.0 | Initial draft of story 3.2 | Bob (Scrum Master) |
| 2025-10-12 | 1.1 | Implemented user search and filtering functionality. | James (Developer) |


