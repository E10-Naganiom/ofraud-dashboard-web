# <!-- Powered by BMAD™ Core -->
# Story 3.1: User List Page with Basic Display

## Status
Done

## Story
**As a** administrator,
**I want** to view a paginated list of all registered users (both admins and regular users),
**so that** I can monitor the user base and identify accounts needing management.

## Acceptance Criteria
1. User list page created at `/dashboard/users` route.
2. Page layout includes: page title "Gestión de Usuarios", search bar placeholder, user list container, "Crear Usuario" button.
3. On page load, display a list of mock users. The backend fetch is disabled for this story.
4. Display users in table format with columns:
   - ID (numeric)
   - Nombre completo (concatenate `nombre` + `apellido`)
   - Correo electrónico
   - Rol (badge: "Admin" if `is_admin=true`, "Usuario" if `is_admin=false`)
   - Estado (badge: "Activo" if `is_active=true`, "Inactivo" if `is_active=false`)
   - Acciones (edit icon, activate/deactivate toggle)
5. Pagination: default 10 users per page with "Previous" and "Next" buttons.
6. Loading state shown initially before mock data is displayed.
7. Empty state: "No hay usuarios registrados" (when mock data is an empty array).
8. Error state: "Error al cargar usuarios. Intente nuevamente." (simulated via a toggle).
9. Each user row is clickable and navigates to the edit page `/dashboard/users/[id]`.

## Dev Notes
This section contains all relevant technical details extracted from project documentation. The developer agent should not need to read the full architecture documents.

### User Request Override
- The user requested to create story 3.1 with a focus on frontend flow, unblocked by backend functionality.
- All data fetching from the API (`GET /admin/user/list`) is replaced with a mock data array.
- The user list should be hardcoded or generated by a utility function within the frontend.

### Data Models
- A mock `User` type should be created in `src/lib/types/user.types.ts` if it doesn't exist, based on the table columns.
- **`User` type fields**:
  - `id`: `number`
  - `nombre`: `string`
  - `apellido`: `string`
  - `email`: `string`
  - `is_admin`: `boolean`
  - `is_active`: `boolean`
- A mock data generator for users should be created in `src/lib/mock/users.ts`.
- [Source: `docs/prd/epic-3-user-administration-profile-management.md`, `docs/architecture/source-tree.md`]

### API Specifications
- **No API calls are required for this story.**
- A mock function that returns a promise resolving with an array of mock `User` objects should be used to simulate an API call. This helps in testing loading/error states.
- [Source: User override request]

### Component Specifications
- **User Table**: Use the `Table` component from `shadcn/ui` (`@/components/ui/table`).
- **Badges**: Use the `Badge` component from `shadcn/ui` (`@/components/ui/badge`) for "Rol" and "Estado".
- **Buttons**: Use the `Button` component from `shadcn/ui` (`@/components/ui/button`) for "Crear Usuario" and pagination.
- **Icons**: Use a library like `lucide-react` for edit and toggle icons.
- **Component Location**: The main page component is `src/app/(dashboard)/users/page.tsx`. It is recommended to create a `UserList.tsx` component in `src/components/users/` to contain the table and its logic.
- **State Management**:
    - Use `useState` to manage the list of users, loading state, and error state.
    - Use `useState` for pagination (current page).
- [Source: `docs/architecture/source-tree.md`, `docs/architecture/tech-stack.md`]

### File Locations
- **New Page**: `src/app/(dashboard)/users/page.tsx`
- **New Component**: `src/components/users/UserList.tsx` (recommended)
- **New Types**: `src/lib/types/user.types.ts`
- **New Mock Data**: `src/lib/mock/users.ts`
- [Source: `docs/architecture/source-tree.md`]

### Navigation
- The "Crear Usuario" button should link to `/dashboard/users/new`.
- Clicking a user row should navigate to `/dashboard/users/[id]`. Note the PRD specified `/edit` at the end, but the `source-tree.md` does not have it. Follow the `source-tree.md` structure.
- [Source: `docs/architecture/source-tree.md`]

## Tasks / Subtasks
- [x] **Task 1: Create Mock Data and Types** (AC: 3)
    - [x] In `src/lib/types/user.types.ts`, define and export the `User` interface.
    - [x] In `src/lib/mock/users.ts`, create a function that generates and returns an array of 15-20 mock `User` objects.

- [x] **Task 2: Build the User List Component** (AC: 4, 5, 9)
    - [x] Create a new component `src/components/users/UserList.tsx`.
    - [x] Implement a `shadcn/ui` `Table` to display the user data.
    - [x] The table should have columns for ID, Nombre, Correo, Rol, Estado, and Acciones.
    - [x] Format "Nombre completo" by combining `nombre` and `apellido`.
    - [x] Use `Badge` components for the "Rol" and "Estado" columns.
    - [x] Add placeholder icons for "Edit" and "Activate/Deactivate" in the "Acciones" column.
    - [x] Implement pagination logic to display 10 users per page.
    - [x] Make each row clickable to navigate to `/dashboard/users/[id]`.

- [x] **Task 3: Create the User Management Page** (AC: 1, 2, 6, 7, 8)
    - [x] Create the page file `src/app/(dashboard)/users/page.tsx`.
    - [x] Add the page title "Gestión de Usuarios".
    - [x] Add a `Button` with the text "Crear Usuario" that links to `/dashboard/users/new`.
    - [x] Add a placeholder for the search bar (an `Input` component).
    - [x] Implement state for loading, error, and user data.
    - [x] Create a simulated fetch function that uses the mock data generator and includes a delay to show the loading state.
    - [x] Render the `UserList` component with the mock data.
    - [x] Conditionally render loading, empty, and error states based on the component's state.

- [N/A] **Task 4: Testing**
    - [N/A] As per `coding-standards.md`, testing is post-MVP. No testing tasks are required for this story.

## Testing
- No `testing-strategy.md` document was found.
- The `coding-standards.md` document specifies that unit tests should be co-located with components (e.g., `button.test.tsx` alongside `button.tsx`).
- Testing is considered a post-MVP task for this project.

## Change Log
| Date | Version | Description | Author |
|---|---|---|---|
| 2025-10-12 | 1.0 | Initial draft of story 3.1 | Bob (Scrum Master) |
| 2025-10-12 | 1.1 | Completed all tasks for Story 3.1. | James (Developer) |

## Dev Agent Record

### Completion Notes
- All tasks for story 3.1 have been completed.
- The implementation uses mock data as requested and is not dependent on the backend.
- The project had several pre-existing build errors that had to be fixed to complete this story. These fixes involved correcting type inconsistencies across several files.
- The existing test suite is failing, but the failures are unrelated to the changes made in this story.

### File List
**Created:**
- `src/lib/types/user.types.ts`
- `src/lib/mock/users.ts`
- `src/components/users/UserList.tsx`
- `src/app/(dashboard)/users/page.tsx`
- `src/lib/utils/cn.ts`

**Modified:**
- `src/components/incidents/IncidentEvaluationForm.tsx`
- `src/lib/api/users.ts`
